<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="A practical, security-focused guide to Source Code Review (static HTML)." />
  <title>Source Code Review â€” Practical Guide</title>

  <style>
    :root{
      --bg:#0b1020;
      --card:#101a33;
      --muted:#a9b4d0;
      --text:#eef2ff;
      --accent:#7aa2ff;
      --accent2:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border: rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: var(--sans);
      background: var(--bg);
      color: var(--text);
      line-height:1.6;
    }
    a{color:var(--accent); text-decoration:none}
    header, main{max-width:1200px; margin:auto; padding:18px}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:16px;
      margin-top:18px;
      box-shadow:var(--shadow);
    }
    .toc a{
      display:block;
      padding:6px 0;
      color:var(--text);
    }
    .muted{color:var(--muted)}
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    @media(max-width:800px){.grid2{grid-template-columns:1fr}}
    .callout{
      border:1px dashed var(--border);
      border-radius:12px;
      padding:12px;
      background:#0e1630;
    }
    .tag{
      font-size:12px;
      margin-bottom:6px;
      color:var(--muted);
    }
    pre{
      background:#070c1f;
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px;
      overflow:auto;
      font-family:var(--mono);
      font-size:12px;
    }
    details summary{cursor:pointer; margin-top:8px}
    .comparison-table {
  border-collapse: collapse;
  width: 100%;
  max-width: 600px;
}

.comparison-table th,
.comparison-table td {
  border: 1px solid #ccc;
  padding: 8px 12px;
  text-align: left;
}

.comparison-table thead {
  background-color: #343591;
}

.table-note {
  margin-top: 8px;
  font-style: italic;
}

  </style>
</head>

<body>

<header>
  <h1>Source Code Review â€” Practical Guide</h1>
  <p class="muted">Simple knowladge base for source code review </p>
</header>

<main>


  <!-- CONTENT -->

  <section id="what" class="card">
    <h2>1) What is Source Code Review?</h2>
    <p class="muted">
      Source code review is the systematic examination of application source code
      to identify security vulnerabilities, logic flaws, and unsafe design patterns
      before exploitation occurs.
    </p>
  </section>


  <section id="types" class="card">
    <h2>2) Types of Code Review</h2>
    <ul>
      <li><strong>Manual review:</strong> human logic analysis</li>
      <li><strong>Assisted review:</strong> manual + SAST/automation</li>
    </ul>
  </section>

  <section id="workflow" class="card">
    <h2>3) Review Workflow</h2>
    <ol>
      <li><b>Identify entry points</b></li>
      <li><b>Understand trust boundaries:</b> Knowing exactly where the level of trust changes in a system and never assuming data is safe after it crosses those points.</li>
      <p><strong>A trust boundary is a line where:</strong></p>

<ul class="trust-boundary-list">
  <li>Data moves from <em>less trusted</em> â†’ <em>more trusted</em></li>
  <li>Control moves from <em>external</em> â†’ <em>internal</em></li>
  <li>Privileges change (<em>user â†’ admin â†’ system</em>)</li>
</ul>

<p class="trust-boundary-note">
  When data crosses that line, security checks must happen.
</p>

      <li><b>Trace data flows: </b>means following data step-by-step through the code to understand where data comes from, how it is transformed, and where it ends up
        <ul class="trace-list">
            <li><strong>When you trace data flows, you ask:</strong></li>
            <li>Where did this data originate?</li>
            <li>What happens to it along the way?</li>
            <li>Where is it finally used?</li>
            <li>Is it validated, sanitized, or authorized before that use?</li>
            <li class="note">
              This is the core skill behind finding injection, IDOR, SSRF, XSS, RCE, and logic flaws.
            </li>
          </ul>
          
      </li>
      <li><b>Locate sinks and sources</b></li> <br> </br>  
      <div class="grid2">
        <div class="callout">
          <h4>What is a Sink?</h4>
            A <strong>sink</strong> is a location where untrusted input/data is executed, interpreted that can cause harm.
            part of code "operation" where it process and handle the user input. such as: 
        
          <ul>
            <li>SQL execution â†’ SQL Injection</li>
            <li>HTML rendering â†’ XSS</li>
            <li>File access â†’ Path Traversal</li>
            <li>HTTP requests â†’ SSRF</li>
          </ul>
  
          <pre><code>// Sink example
  fs.readFile(userPath)</code></pre>

  <pre><code> db.query("SELECT * FROM users WHERE id=" + user_input)</code></pre>
        </div>
  
        <div class="callout">
          <h4>What is a Source?</h4>
          <p>
            A <strong>source</strong> is where data originates "entry points to application", often attacker-controlled, the injection point.
          </p>
          <ul>
            <li>HTTP request parameters</li>
            <li>Headers & cookies</li>
            <li>Uploaded files</li>
          </ul>
  
          <pre><code>// Source example
  userPath = request.query.file</code></pre>

  <pre><code>// SOURCE: attacker-controlled input and http request parameter
    user_id = request.args.get("id")</code></pre>

        </div>
  
      </div>
  




      <table class="comparison-table">
        <caption>Trust Boundary vs Data Flow (Difference)</caption>
        <thead>
          <tr>
            <th>Concept</th>
            <th>Focus</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Trust boundary</td>
            <td><strong>WHO</strong> is providing the data</td>
          </tr>
          <tr>
            <td>Data flow</td>
            <td><strong>WHERE</strong> the data travels</td>
          </tr>
        </tbody>
      </table>
      
      <p class="table-note">
        You must understand both to review code correctly.
      </p>
      
    </ol>
  </section>

  <section id="threat" class="card">
    <h2>4) Threat Modeling (Lite)</h2>
    <ul>
      <li>Who can access this feature?</li>
      <li>What asset is protected?</li>
      <li>What input is attacker-controlled?</li>
      <li>What is the worst misuse?</li>
    </ul>
  </section>

  <section id="hotspots" class="card">
    <h2>5) Security Hotspots</h2>
    <h4>Security hotspots are high-risk areas of code where untrusted input meets sensitive operations, making them the most likely locations for serious vulnerabilities where we can start our code review from.</h4>
    <ul>
      <li>Authentication & authorization</li>
      <li>File uploads & parsing</li>
      <li>Database access</li>
      <li>Template rendering</li>
      <li>External HTTP requests</li>
    </ul>
  </section>



  <!-- ðŸ”¥ NEW METHODOLOGY SECTION -->
  <section id="methodology" class="card">
    <h2>6) Source Code Review Methodologies</h2>
    <p class="muted">
      Effective code review relies on understanding <strong>how to read code</strong>.
      Security reviewers mainly use two complementary approaches:
      <ul>
          <li><strong>Top-Down: Source to Sink</strong> </li>
          <li><strong>Bottom-Up: Sink to Source</strong></li>
      </ul>
    </p>

    <div class="grid2">

      <div class="callout">
        <h3>Top-Down Approach </h3>
        <p>
          Start from <strong>entry points</strong> (controllers, routes, APIs)
          and then ollow execution deeper into the application to sink's, identify functionality and see what controls are in place (such as input validation, file extension whitelisting).
        </p>
        <ul>
          <li>Best for: authorization & logic flaws</li>
          <li>Focus: business rules and permissions</li>
          <li>Likely to uncover lower-severity vulnerabilities with a higher likelihood of exposure.</li>
        </ul>

        <pre><code>// Entry point
function transferMoney(request) {
  userId = request.session.userId
  amount = request.body.amount

  // Is authorization checked here?
  processTransfer(userId, amount)
}</code></pre>
<pre><code>id = request.query.id // Source</code></pre>
      </div>

      <div class="callout">
        <h3>Bottom-Up Approach</h3>
        <p>
          Start from <strong>dangerous operations</strong> and trace backwards the data flow
          to find where the data originates "the injection point".
        </p>
        <ul>
          <li>Best for: injection, RCE, SSRF</li>
          <li>Also called <strong>Sink-to-Source</strong></li>
          <li>more likely to result in higher-severity vulnerabilities with a lower likelihood of exposure</li>
        </ul>

        <pre><code>// Sink
db.query("SELECT * FROM users WHERE id=" + id)

// Trace data flow backwards to the source
id = request.query.id</code></pre>

<pre><code>// SOURCE
comment = request.body.comment

// SINK
response.write("< div>" + comment + "</ div>")</code></pre>
      </div>

    </div>
    Regardless of which approach we use, our end goals are the same: we want to identify vulnerabilities or logic errors in the application, determine how to call the vulnerable code, and bypass restrictions.
    
    <details>
      <summary>Complete Sink-to-Source Example (SSRF)</summary>
      <pre><code>// Source
url = request.body.url

// Weak validation
if (!url.startsWith("https://")) reject()

// Sink
response = httpClient.get(url)

// Risk: SSRF via DNS/IP bypass</code></pre>
    </details>

  </section>

 

  <section id="tools" class="card">
    <h2>7) Tools & Automation</h2>
    <ul>
      <li> <b> SAST (Static Application Security Testing) scanners:</b> SAST analyzes an applicationâ€™s source code without running it to find vulnerabilities.   </li>
      <li> <b> Dependency scanners (SCA): </b>scans your projectâ€™s third-party dependencies (libraries, frameworks, packages) to find known vulnerabilities.</li>
      <li> <b> Secret detection: </b>scans code and repos for hardcoded credentials.</li>
      <li> <b> grep / ripgrep: </b>are fast text-search tools used by humans during code review. they are a searching tool to hunt a keyword regx based not a scanner tool.</li>
    </ul>
  </section>

  <section id="refs" class="card">
    <h2>References</h2>
    <ul>
      <li>OWASP Code Review Guide: https://owasp.org/www-project-code-review-guide/</li>
      <li>Cobalt: https://www.cobalt.io/blog/a-pentesters-guide-to-source-code-review</li>
      <li>AWAE/OSWE Note: https://github.com/computer-engineer/WhiteboxPentest</li>
     
    </ul>
  </section>

</main>

</body>
</html>
